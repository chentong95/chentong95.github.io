<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Node.js 文件系统 | CT的博客乐园</title><link rel="stylesheet" type="text/css" href="//fonts.css.network/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Node.js 文件系统</h1><a id="logo" href="/.">CT的博客乐园</a><p class="description">愿你历尽千帆，归来仍是少年。</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">Node.js 文件系统</h1><div class="post-meta"><a href="/2017/07/20/node13/#comments" class="comment-count"></a><p><span class="date">Jul 20, 2017</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><p>Node.js 提供一组类似 UNIX（POSIX）标准的文件操作API。<a id="more"></a> Node 导入文件系统模块(fs)语法如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">"fs"</span>)</div></pre></td></tr></table></figure></p>
<h2 id="异步和同步"><a href="#异步和同步" class="headerlink" title="异步和同步"></a>异步和同步</h2><p>Node.js 文件系统（fs 模块）模块中的方法均有异步和同步版本，例如读取文件内容的函数有异步的fs.readFile()和同步的fs.readFileSync()。<br>异步的方法函数最后一个参数为回调函数，回调函数的第一个参数包含了错误信息(error)。<br>建议大家使用异步方法，比起同步，异步方法性能更高，速度更快，而且没有阻塞。<br><strong>实例</strong><br>创建 input.txt 文件，内容如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">又见花田半亩</div><div class="line">文件读取实例</div></pre></td></tr></table></figure></p>
<p>创建 file.js 文件, 代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">"fs"</span>);</div><div class="line">// 异步读取</div><div class="line">fs.readFile(<span class="string">'input.txt'</span>, function (err, data) &#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> console.error(err);</div><div class="line">   &#125;</div><div class="line">   console.log(<span class="string">"异步读取: "</span> + data.toString());</div><div class="line">&#125;);</div><div class="line">// 同步读取</div><div class="line">var data = fs.readFileSync(<span class="string">'input.txt'</span>);</div><div class="line">console.log(<span class="string">"同步读取: "</span> + data.toString());</div><div class="line">console.log(<span class="string">"程序执行完毕。"</span>);</div></pre></td></tr></table></figure></p>
<p>以上代码执行结果如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ node file.js</div><div class="line">同步读取: ﻿又见花田半亩</div><div class="line">文件读取实例</div><div class="line">程序执行完毕。</div><div class="line">异步读取: ﻿又见花田半亩</div><div class="line">文件读取实例</div></pre></td></tr></table></figure></p>
<p>接下来，让我们来具体了解下 Node.js 文件系统的方法</p>
<h2 id="打开文件"><a href="#打开文件" class="headerlink" title="打开文件"></a>打开文件</h2><p><strong>语法</strong><br>以下为在异步模式下打开文件的语法格式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fs.open(path, flags[, mode], callback)</div></pre></td></tr></table></figure></p>
<p><strong>参数</strong><br>path - 文件的路径。<br>flags - 文件打开的行为。具体值详见下文。<br>mode - 设置文件模式(权限)，文件创建默认权限为 0666(可读，可写)。<br>callback - 回调函数，带有两个参数如：callback(err, fd)。</p>
<p>flags 参数可以是以下值：</p>
<ul>
<li>r    以读取模式打开文件。如果文件不存在抛出异常。</li>
<li>r+    以读写模式打开文件。如果文件不存在抛出异常。</li>
<li>rs    以同步的方式读取文件。</li>
<li>rs+    以同步的方式读取和写入文件。</li>
<li>w    以写入模式打开文件，如果文件不存在则创建。</li>
<li>wx    类似 ‘w’，但是如果文件路径存在，则文件写入失败。</li>
<li>w+    以读写模式打开文件，如果文件不存在则创建。</li>
<li>wx+    类似 ‘w+’， 但是如果文件路径存在，则文件读写失败。</li>
<li>a    以追加模式打开文件，如果文件不存在则创建。</li>
<li>ax    类似 ‘a’， 但是如果文件路径存在，则文件追加失败。</li>
<li>a+    以读取追加模式打开文件，如果文件不存在则创建。</li>
<li>ax+    类似 ‘a+’， 但是如果文件路径存在，则文件读取追加失败。</li>
</ul>
<p><strong>实例</strong><br>接下来我们创建 file.js 文件，并打开 input.txt 文件进行读写，代码如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">"fs"</span>);</div><div class="line">// 异步打开文件</div><div class="line">console.log(<span class="string">"准备打开文件！"</span>);</div><div class="line">fs.open(<span class="string">'input.txt'</span>, <span class="string">'r+'</span>, function(err, fd) &#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> console.error(err);</div><div class="line">   &#125;</div><div class="line">  console.log(<span class="string">"文件打开成功！"</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>以上代码执行结果如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ node file.js</div><div class="line">准备打开文件！</div><div class="line">文件打开成功！</div></pre></td></tr></table></figure></p>
<h2 id="获取文件信息"><a href="#获取文件信息" class="headerlink" title="获取文件信息"></a>获取文件信息</h2><p><strong>语法</strong><br>以下为通过异步模式获取文件信息的语法格式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fs.stat(path, callback)</div></pre></td></tr></table></figure></p>
<p>参数</p>
<ul>
<li>path - 文件路径。</li>
<li>callback - 回调函数，带有两个参数如：(err, stats), stats 是 fs.Stats 对象。</li>
<li>fs.stat(path)执行后，会将stats类的实例返回给其回调函数。可以通过stats类中的提供方法判断文件的相关属性。例如判断是否为文件：<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">'fs'</span>);</div><div class="line">fs.stat(<span class="string">'/Users/liuht/code/itbilu/demo/fs.js'</span>, function (err, stats) &#123;</div><div class="line">    console.log(stats.isFile()); 		//true</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<p>stats.isFile()    如果是文件返回 true，否则返回 false。<br>stats.isDirectory()    如果是目录返回 true，否则返回 false。<br>stats.isBlockDevice()    如果是块设备返回 true，否则返回 false。<br>stats.isCharacterDevice()    如果是字符设备返回 true，否则返回 false。<br>stats.isSymbolicLink()    如果是软链接返回 true，否则返回 false。<br>stats.isFIFO()    如果是FIFO，返回true，否则返回 false。FIFO是UNIX中的一种特殊类型的命令管道。<br>stats.isSocket()    如果是 Socket 返回 true，否则返回 false。</p>
<p><strong>实例</strong><br>接下来我们创建 file.js 文件，代码如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">"fs"</span>);</div><div class="line">console.log(<span class="string">"准备打开文件！"</span>);</div><div class="line">fs.stat(<span class="string">'input.txt'</span>, function (err, stats) &#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> console.error(err);</div><div class="line">   &#125;</div><div class="line">   console.log(stats);</div><div class="line">   console.log(<span class="string">"读取文件信息成功！"</span>);</div><div class="line">   // 检测文件类型</div><div class="line">   console.log(<span class="string">"是否为文件(isFile) ? "</span> + stats.isFile());</div><div class="line">   console.log(<span class="string">"是否为目录(isDirectory) ? "</span> + stats.isDirectory());</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>以上代码执行结果如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">$ node file.js</div><div class="line">准备打开文件！</div><div class="line">&#123; dev: 16777220,</div><div class="line">  mode: 33188,</div><div class="line">  nlink: 1,</div><div class="line">  uid: 501,</div><div class="line">  gid: 20,</div><div class="line">  rdev: 0,</div><div class="line">  blksize: 4096,</div><div class="line">  ino: 40333161,</div><div class="line">  size: 61,</div><div class="line">  blocks: 8,</div><div class="line">  atime: Mon Sep 07 2015 17:43:55 GMT+0800 (CST),</div><div class="line">  mtime: Mon Sep 07 2015 17:22:35 GMT+0800 (CST),</div><div class="line">  ctime: Mon Sep 07 2015 17:22:35 GMT+0800 (CST) &#125;</div><div class="line">读取文件信息成功！</div><div class="line">是否为文件(isFile) ? true</div><div class="line">是否为目录(isDirectory) ? false</div></pre></td></tr></table></figure></p>
<h2 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h2><p><strong>语法</strong><br>以下为异步模式下写入文件的语法格式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fs.writeFile(file, data[, options], callback)</div></pre></td></tr></table></figure></p>
<p>如果文件存在，该方法写入的内容会覆盖旧的文件内容。<br>参数</p>
<ul>
<li>file - 文件名或文件描述符。</li>
<li>data - 要写入文件的数据，可以是 String(字符串) 或 Buffer(流) 对象。</li>
<li>options - 该参数是一个对象，包含 {encoding, mode, flag}。默认编码为 utf8, 模式为 0666 ， flag 为 ‘w’</li>
<li>callback - 回调函数，回调函数只包含错误信息参数(err)，在写入失败时返回。</li>
</ul>
<p><strong>实例</strong><br>接下来我们创建 file.js 文件，代码如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">"fs"</span>);</div><div class="line">console.log(<span class="string">"准备写入文件"</span>);</div><div class="line">fs.writeFile(<span class="string">'input.txt'</span>, <span class="string">'我是通过写入的文件内容！'</span>,  function(err) &#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> console.error(err);</div><div class="line">   &#125;</div><div class="line">   console.log(<span class="string">"数据写入成功！"</span>);</div><div class="line">   console.log(<span class="string">"--------我是分割线-------------"</span>)</div><div class="line">   console.log(<span class="string">"读取写入的数据！"</span>);</div><div class="line">   fs.readFile(<span class="string">'input.txt'</span>, function (err, data) &#123;</div><div class="line">      <span class="keyword">if</span> (err) &#123;</div><div class="line">         <span class="keyword">return</span> console.error(err);</div><div class="line">      &#125;</div><div class="line">      console.log(<span class="string">"异步读取文件数据: "</span> + data.toString());</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>以上代码执行结果如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ node file.js</div><div class="line">准备写入文件</div><div class="line">数据写入成功！</div><div class="line">--------我是分割线-------------</div><div class="line">读取写入的数据！</div><div class="line">异步读取文件数据: 我是通过写入的文件内容！</div></pre></td></tr></table></figure></p>
<h2 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h2><p><strong>语法</strong><br>以下为异步模式下读取文件的语法格式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fs.read(fd, buffer, offset, length, position, callback)</div></pre></td></tr></table></figure></p>
<p>该方法使用了文件描述符来读取文件。<br><strong>参数</strong><br>fd - 通过 fs.open() 方法返回的文件描述符。<br>buffer - 数据写入的缓冲区。<br>offset - 缓冲区写入的写入偏移量。<br>length - 要从文件中读取的字节数。<br>position - 文件读取的起始位置，如果 position 的值为 null，则会从当前文件指针的位置读取。<br>callback - 回调函数，有三个参数err, bytesRead, buffer，err 为错误信息， bytesRead 表示读取的字节数，buffer 为缓冲区对象。<br><strong>实例</strong><br>input.txt 文件内容为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">哈喽呀，你好呀</div></pre></td></tr></table></figure></p>
<p>接下来我们创建 file.js 文件，代码如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">"fs"</span>);</div><div class="line">var buf = new Buffer(<span class="number">1024</span>);</div><div class="line">console.log(<span class="string">"准备打开已存在的文件！"</span>);</div><div class="line">fs.open(<span class="string">'input.txt'</span>, <span class="string">'r+'</span>, function(err, fd) &#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> console.error(err);</div><div class="line">   &#125;</div><div class="line">   console.log(<span class="string">"文件打开成功！"</span>);</div><div class="line">   console.log(<span class="string">"准备读取文件："</span>);</div><div class="line">   fs.read(fd, buf, <span class="number">0</span>, buf.length, <span class="number">0</span>, function(err, bytes)&#123;</div><div class="line">      <span class="keyword">if</span> (err)&#123;</div><div class="line">         console.log(err);</div><div class="line">      &#125;</div><div class="line">      console.log(bytes + <span class="string">"  字节被读取"</span>);</div><div class="line">      // 仅输出读取的字节</div><div class="line">      <span class="keyword">if</span>(bytes &gt; <span class="number">0</span>)&#123;</div><div class="line">         console.log(buf.slice(<span class="number">0</span>, bytes).toString());</div><div class="line">      &#125;</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>以上代码执行结果如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ node file.js</div><div class="line">准备打开已存在的文件！</div><div class="line">文件打开成功！</div><div class="line">准备读取文件：</div><div class="line"><span class="number">24</span>  字节被读取</div><div class="line">哈喽呀，你好呀</div></pre></td></tr></table></figure></p>
<h2 id="关闭文件"><a href="#关闭文件" class="headerlink" title="关闭文件"></a>关闭文件</h2><p>语法<br>以下为异步模式下关闭文件的语法格式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fs.close(fd, callback)</div></pre></td></tr></table></figure></p>
<p>该方法使用了文件描述符来读取文件。<br>参数使用说明如下：</p>
<ul>
<li>fd - 通过 fs.open() 方法返回的文件描述符。</li>
<li>callback - 回调函数，没有参数。</li>
</ul>
<p><strong>实例</strong><br>input.txt 文件内容为：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">哈喽呀，你好呀</div></pre></td></tr></table></figure></p>
<p>接下来我们创建 file.js 文件，代码如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">"fs"</span>);</div><div class="line">var buf = new Buffer(<span class="number">1024</span>);</div><div class="line">console.log(<span class="string">"准备打开文件！"</span>);</div><div class="line">fs.open(<span class="string">'input.txt'</span>, <span class="string">'r+'</span>, function(err, fd) &#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> console.error(err);</div><div class="line">   &#125;</div><div class="line">   console.log(<span class="string">"文件打开成功！"</span>);</div><div class="line">   console.log(<span class="string">"准备读取文件！"</span>);</div><div class="line">   fs.read(fd, buf, <span class="number">0</span>, buf.length, <span class="number">0</span>, function(err, bytes)&#123;</div><div class="line">      <span class="keyword">if</span> (err)&#123;</div><div class="line">         console.log(err);</div><div class="line">      &#125;</div><div class="line">      // 仅输出读取的字节</div><div class="line">      <span class="keyword">if</span>(bytes &gt; <span class="number">0</span>)&#123;</div><div class="line">         console.log(buf.slice(<span class="number">0</span>, bytes).toString());</div><div class="line">      &#125;</div><div class="line">      // 关闭文件</div><div class="line">      fs.close(fd, function(err)&#123;</div><div class="line">         <span class="keyword">if</span> (err)&#123;</div><div class="line">            console.log(err);</div><div class="line">         &#125;</div><div class="line">         console.log(<span class="string">"文件关闭成功"</span>);</div><div class="line">      &#125;);</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>以上代码执行结果如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ node file.js</div><div class="line">准备打开文件！</div><div class="line">文件打开成功！</div><div class="line">准备读取文件！</div><div class="line">哈喽呀，你好呀</div><div class="line">文件关闭成功</div></pre></td></tr></table></figure></p>
<h2 id="截取文件"><a href="#截取文件" class="headerlink" title="截取文件"></a>截取文件</h2><p><strong>语法</strong><br>以下为异步模式下截取文件的语法格式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fs.ftruncate(fd, len, callback)</div></pre></td></tr></table></figure></p>
<p>该方法使用了文件描述符来读取文件。<br><strong>参数</strong></p>
<ul>
<li>fd - 通过 fs.open() 方法返回的文件描述符。</li>
<li>len - 文件内容截取的长度。</li>
<li>callback - 回调函数，没有参数。<br><strong>实例</strong><br>input.txt 文件内容为：<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">www.baidu.com</div></pre></td></tr></table></figure>
</li>
</ul>
<p>接下来我们创建 file.js 文件，代码如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">"fs"</span>);</div><div class="line">var buf = new Buffer(<span class="number">1024</span>);</div><div class="line">console.log(<span class="string">"准备打开文件！"</span>);</div><div class="line">fs.open(<span class="string">'input.txt'</span>, <span class="string">'r+'</span>, function(err, fd) &#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> console.error(err);</div><div class="line">   &#125;</div><div class="line">   console.log(<span class="string">"文件打开成功！"</span>);</div><div class="line">   console.log(<span class="string">"截取10字节后的文件内容。"</span>);</div><div class="line">   // 截取文件</div><div class="line">   fs.ftruncate(fd, <span class="number">10</span>, function(err)&#123;</div><div class="line">      <span class="keyword">if</span> (err)&#123;</div><div class="line">         console.log(err);</div><div class="line">      &#125;</div><div class="line">      console.log(<span class="string">"文件截取成功。"</span>);</div><div class="line">      console.log(<span class="string">"读取相同的文件"</span>);</div><div class="line">      fs.read(fd, buf, <span class="number">0</span>, buf.length, <span class="number">0</span>, function(err, bytes)&#123;</div><div class="line">         <span class="keyword">if</span> (err)&#123;</div><div class="line">            console.log(err);</div><div class="line">         &#125;</div><div class="line">         // 仅输出读取的字节</div><div class="line">         <span class="keyword">if</span>(bytes &gt; <span class="number">0</span>)&#123;</div><div class="line">            console.log(buf.slice(<span class="number">0</span>, bytes).toString());</div><div class="line">         &#125;</div><div class="line">         // 关闭文件</div><div class="line">         fs.close(fd, function(err)&#123;</div><div class="line">            <span class="keyword">if</span> (err)&#123;</div><div class="line">               console.log(err);</div><div class="line">            &#125;</div><div class="line">            console.log(<span class="string">"文件关闭成功！"</span>);</div><div class="line">         &#125;);</div><div class="line">      &#125;);</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>以上代码执行结果如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$ node file.js</div><div class="line">准备打开文件！</div><div class="line">文件打开成功！</div><div class="line">截取<span class="number">10</span>字节后的文件内容。</div><div class="line">文件截取成功。</div><div class="line">读取相同的文件</div><div class="line">www.bai</div><div class="line">文件关闭成功！</div></pre></td></tr></table></figure></p>
<h2 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h2><p><strong>语法</strong><br>以下为删除文件的语法格式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fs.unlink(path, callback)</div></pre></td></tr></table></figure></p>
<p><strong>参数</strong></p>
<ul>
<li>path - 文件路径。</li>
<li>callback - 回调函数，没有参数。<br><strong>实例</strong><br>input.txt 文件内容为：<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">www.baidu.com</div></pre></td></tr></table></figure>
</li>
</ul>
<p>接下来我们创建 file.js 文件，代码如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">"fs"</span>);</div><div class="line">console.log(<span class="string">"准备删除文件！"</span>);</div><div class="line">fs.unlink(<span class="string">'input.txt'</span>, function(err) &#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> console.error(err);</div><div class="line">   &#125;</div><div class="line">   console.log(<span class="string">"文件删除成功！"</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>以上代码执行结果如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ node file.js</div><div class="line">准备删除文件！</div><div class="line">文件删除成功！</div></pre></td></tr></table></figure></p>
<p>再去查看 input.txt 文件，发现已经不存在了。</p>
<h2 id="创建目录"><a href="#创建目录" class="headerlink" title="创建目录"></a>创建目录</h2><p><strong>语法</strong><br>以下为创建目录的语法格式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fs.mkdir(path[, mode], callback)</div></pre></td></tr></table></figure></p>
<p><strong>参数</strong></p>
<ul>
<li>path - 文件路径。</li>
<li>mode - 设置目录权限，默认为 0777。</li>
<li>callback - 回调函数，没有参数。<br><strong>实例</strong><br>接下来我们创建 file.js 文件，代码如下所示：<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">"fs"</span>);</div><div class="line">console.log(<span class="string">"查看 /tmp 目录"</span>);</div><div class="line">fs.readdir(<span class="string">"/tmp/"</span>,function(err, files)&#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> console.error(err);</div><div class="line">   &#125;</div><div class="line">   files.forEach( function (file)&#123;</div><div class="line">       console.log( file );</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>以上代码执行结果如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ node file.js</div><div class="line">查看 /tmp 目录</div><div class="line">input.out</div><div class="line">output.out</div><div class="line">test</div><div class="line">test.txt</div></pre></td></tr></table></figure></p>
<h2 id="删除目录"><a href="#删除目录" class="headerlink" title="删除目录"></a>删除目录</h2><p><strong>语法</strong><br>以下为删除目录的语法格式：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fs.rmdir(path, callback)</div></pre></td></tr></table></figure></p>
<p><strong>参数</strong><br>path - 文件路径。<br>callback - 回调函数，没有参数。<br><strong>实例</strong><br>接下来我们创建 file.js 文件，代码如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">var fs = require(<span class="string">"fs"</span>);</div><div class="line">// 执行前创建一个空的 /tmp/test 目录</div><div class="line">console.log(<span class="string">"准备删除目录 /tmp/test"</span>);</div><div class="line">fs.rmdir(<span class="string">"/tmp/test"</span>,function(err)&#123;</div><div class="line">   <span class="keyword">if</span> (err) &#123;</div><div class="line">       <span class="keyword">return</span> console.error(err);</div><div class="line">   &#125;</div><div class="line">   console.log(<span class="string">"读取 /tmp 目录"</span>);</div><div class="line">   fs.readdir(<span class="string">"/tmp/"</span>,function(err, files)&#123;</div><div class="line">      <span class="keyword">if</span> (err) &#123;</div><div class="line">          <span class="keyword">return</span> console.error(err);</div><div class="line">      &#125;</div><div class="line">      files.forEach( function (file)&#123;</div><div class="line">          console.log( file );</div><div class="line">      &#125;);</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>以上代码执行结果如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ node file.js</div><div class="line">准备删除目录 /tmp/test</div><div class="line">读取 /tmp 目录</div><div class="line">……</div></pre></td></tr></table></figure></p>
<h2 id="文件模块方法参考手册"><a href="#文件模块方法参考手册" class="headerlink" title="文件模块方法参考手册"></a>文件模块方法参考手册</h2><p>以下为 Node.js 文件模块相同的方法列表：<br>1    fs.rename(oldPath, newPath, callback)<br>异步 rename().回调函数没有参数，但可能抛出异常。<br>2    fs.ftruncate(fd, len, callback)<br>异步 ftruncate().回调函数没有参数，但可能抛出异常。<br>3    fs.ftruncateSync(fd, len)<br>同步 ftruncate()<br>4    fs.truncate(path, len, callback)<br>异步 truncate().回调函数没有参数，但可能抛出异常。<br>5    fs.truncateSync(path, len)<br>同步 truncate()<br>6    fs.chown(path, uid, gid, callback)<br>异步 chown().回调函数没有参数，但可能抛出异常。<br>7    fs.chownSync(path, uid, gid)<br>同步 chown()<br>8    fs.fchown(fd, uid, gid, callback)<br>异步 fchown().回调函数没有参数，但可能抛出异常。<br>9    fs.fchownSync(fd, uid, gid)<br>同步 fchown()<br>10    fs.lchown(path, uid, gid, callback)<br>异步 lchown().回调函数没有参数，但可能抛出异常。<br>11    fs.lchownSync(path, uid, gid)<br>同步 lchown()<br>12    fs.chmod(path, mode, callback)<br>异步 chmod().回调函数没有参数，但可能抛出异常。<br>13    fs.chmodSync(path, mode)<br>同步 chmod().<br>14    fs.fchmod(fd, mode, callback)<br>异步 fchmod().回调函数没有参数，但可能抛出异常。<br>15    fs.fchmodSync(fd, mode)<br>同步 fchmod().<br>16    fs.lchmod(path, mode, callback)<br>异步 lchmod().回调函数没有参数，但可能抛出异常。Only available on Mac OS X.<br>17    fs.lchmodSync(path, mode)<br>同步 lchmod().<br>18    fs.stat(path, callback)<br>异步 stat(). 回调函数有两个参数 err, stats，stats 是 fs.Stats 对象。<br>19    fs.lstat(path, callback)<br>异步 lstat(). 回调函数有两个参数 err, stats，stats 是 fs.Stats 对象。<br>20    fs.fstat(fd, callback)<br>异步 fstat(). 回调函数有两个参数 err, stats，stats 是 fs.Stats 对象。<br>21    fs.statSync(path)<br>同步 stat(). 返回 fs.Stats 的实例。<br>22    fs.lstatSync(path)<br>同步 lstat(). 返回 fs.Stats 的实例。<br>23    fs.fstatSync(fd)<br>同步 fstat(). 返回 fs.Stats 的实例。<br>24    fs.link(srcpath, dstpath, callback)<br>异步 link().回调函数没有参数，但可能抛出异常。<br>25    fs.linkSync(srcpath, dstpath)<br>同步 link().<br>26    fs.symlink(srcpath, dstpath[, type], callback)<br>异步 symlink().回调函数没有参数，但可能抛出异常。 type 参数可以设置为 ‘dir’, ‘file’, 或 ‘junction’ (默认为 ‘file’) 。<br>27    fs.symlinkSync(srcpath, dstpath[, type])<br>同步 symlink().<br>28    fs.readlink(path, callback)<br>异步 readlink(). 回调函数有两个参数 err, linkString。<br>29    fs.realpath(path[, cache], callback)<br>异步 realpath(). 回调函数有两个参数 err, resolvedPath。<br>30    fs.realpathSync(path[, cache])<br>同步 realpath()。返回绝对路径。<br>31    fs.unlink(path, callback)<br>异步 unlink().回调函数没有参数，但可能抛出异常。<br>32    fs.unlinkSync(path)<br>同步 unlink().<br>33    fs.rmdir(path, callback)<br>异步 rmdir().回调函数没有参数，但可能抛出异常。<br>34    fs.rmdirSync(path)<br>同步 rmdir().<br>35    fs.mkdir(path[, mode], callback)<br>S异步 mkdir(2).回调函数没有参数，但可能抛出异常。 mode defaults to 0777.<br>36    fs.mkdirSync(path[, mode])<br>同步 mkdir().<br>37    fs.readdir(path, callback)<br>异步 readdir(3). 读取目录的内容。<br>38    fs.readdirSync(path)<br>同步 readdir().返回文件数组列表。<br>39    fs.close(fd, callback)<br>异步 close().回调函数没有参数，但可能抛出异常。<br>40    fs.closeSync(fd)<br>同步 close().<br>41    fs.open(path, flags[, mode], callback)<br>异步打开文件。<br>42    fs.openSync(path, flags[, mode])<br>同步 version of fs.open().<br>43    fs.utimes(path, atime, mtime, callback)</p>
<p>44    fs.utimesSync(path, atime, mtime)<br>修改文件时间戳，文件通过指定的文件路径。<br>45    fs.futimes(fd, atime, mtime, callback)</p>
<p>46    fs.futimesSync(fd, atime, mtime)<br>修改文件时间戳，通过文件描述符指定。<br>47    fs.fsync(fd, callback)<br>异步 fsync.回调函数没有参数，但可能抛出异常。<br>48    fs.fsyncSync(fd)<br>同步 fsync.<br>49    fs.write(fd, buffer, offset, length[, position], callback)<br>将缓冲区内容写入到通过文件描述符指定的文件。<br>50    fs.write(fd, data[, position[, encoding]], callback)<br>通过文件描述符 fd 写入文件内容。<br>51    fs.writeSync(fd, buffer, offset, length[, position])<br>同步版的 fs.write()。<br>52    fs.writeSync(fd, data[, position[, encoding]])<br>同步版的 fs.write().<br>53    fs.read(fd, buffer, offset, length, position, callback)<br>通过文件描述符 fd 读取文件内容。<br>54    fs.readSync(fd, buffer, offset, length, position)<br>同步版的 fs.read.<br>55    fs.readFile(filename[, options], callback)<br>异步读取文件内容。<br>56    fs.readFileSync(filename[, options])<br>57    fs.writeFile(filename, data[, options], callback)<br>异步写入文件内容。<br>58    fs.writeFileSync(filename, data[, options])<br>同步版的 fs.writeFile。<br>59    fs.appendFile(filename, data[, options], callback)<br>异步追加文件内容。<br>60    fs.appendFileSync(filename, data[, options])<br>The 同步 version of fs.appendFile.<br>61    fs.watchFile(filename[, options], listener)<br>查看文件的修改。<br>62    fs.unwatchFile(filename[, listener])<br>停止查看 filename 的修改。<br>63    fs.watch(filename[, options][, listener])<br>查看 filename 的修改，filename 可以是文件或目录。返回 fs.FSWatcher 对象。<br>64    fs.exists(path, callback)<br>检测给定的路径是否存在。<br>65    fs.existsSync(path)<br>同步版的 fs.exists.<br>66    fs.access(path[, mode], callback)<br>测试指定路径用户权限。<br>67    fs.accessSync(path[, mode])<br>同步版的 fs.access。<br>68    fs.createReadStream(path[, options])<br>返回ReadStream 对象。<br>69    fs.createWriteStream(path[, options])<br>返回 WriteStream 对象。<br>70    fs.symlink(srcpath, dstpath[, type], callback)<br>异步 symlink().回调函数没有参数，但可能抛出异常。</p>
</div><div class="tags"><a href="/tags/node/">node</a></div><div class="post-share"></div><div class="post-nav"><a href="/2017/07/20/node14/" class="pre">Node.js GET/POST请求</a><a href="/2017/07/20/node12/" class="next">Node.js 常用工具</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#异步和同步"><span class="toc-text">异步和同步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#打开文件"><span class="toc-text">打开文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#获取文件信息"><span class="toc-text">获取文件信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#写入文件"><span class="toc-text">写入文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#读取文件"><span class="toc-text">读取文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#关闭文件"><span class="toc-text">关闭文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#截取文件"><span class="toc-text">截取文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除文件"><span class="toc-text">删除文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建目录"><span class="toc-text">创建目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除目录"><span class="toc-text">删除目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件模块方法参考手册"><span class="toc-text">文件模块方法参考手册</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/07/27/node16/">Node.js Web 模块</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/21/node15/">Node.js 工具模块</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/node14/">Node.js GET/POST请求</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/node13/">Node.js 文件系统</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/node12/">Node.js 常用工具</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/node11/">Node.js 全局对象</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/node10/">Node.js 路由</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/node09/">Node.js 函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/node08/">Node.js模块系统</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/node07/">Node.js Stream(流)</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/node/" style="font-size: 15px;">node</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="http://www.runoob.com/" title="菜鸟教程" target="_blank">菜鸟教程</a><ul></ul><a href="http://www.imooc.com/" title="慕课网" target="_blank">慕课网</a><ul></ul><a href="http://www.ui.cn/" title="UI中国" target="_blank">UI中国</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</p><p> <span> Copyright &copy;<a href="/." rel="nofollow">又见花田半亩.</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script></body></html>